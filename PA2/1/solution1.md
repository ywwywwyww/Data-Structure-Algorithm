# CST2019 2-1 Build 题解

## 题目大意

　　给一棵有根树，要求支持移动子树以及查询操作。

## 题解

　　因为 cost 之和只与 rank 有关，考虑拿一个栈维护，栈顶为 rank 靠前的子树。

　　这样，每次修改的时候只需要修改栈的最上方 $\Theta(cost)$ 个元素。

　　子树大小可以开一个数组维护，移动子树时维护一下。

　　子树高度也可以像子树一样开一个栈（Steap）维护，移动子树时也只会修改栈的最上方 $\Theta(cost)$ 个元素。

　　这样时间复杂度是 $\Theta(N+M+\sum_i cost_i)$。空间复杂度也是 $\Theta(N+M+\sum_i cost_i)$。

